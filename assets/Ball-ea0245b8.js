import{B as v,V as B,M as H,F as R,u as N,a as P,T as S,r as i,b as I,c as q,E as _,d as G,O as J,_ as K,e as Q,f as Y,j as z,C as V,g as O,h as tt,i as et,P as ot}from"./index-91455d28.js";class rt extends v{constructor(p,h,c,T){super();const l=[],w=[],M=[],d=new B,y=new H;y.makeRotationFromEuler(c),y.setPosition(h);const j=new H;j.copy(y).invert(),k(),this.setAttribute("position",new R(l,3)),this.setAttribute("normal",new R(w,3)),this.setAttribute("uv",new R(M,2));function k(){let t,e=[];const o=new B,s=new B;if(p.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const n=p.geometry,E=n.attributes.position,b=n.attributes.normal;if(n.index!==null){const f=n.index;for(t=0;t<f.count;t++)o.fromBufferAttribute(E,f.getX(t)),s.fromBufferAttribute(b,f.getX(t)),A(e,o,s)}else for(t=0;t<E.count;t++)o.fromBufferAttribute(E,t),s.fromBufferAttribute(b,t),A(e,o,s);for(e=x(e,d.set(1,0,0)),e=x(e,d.set(-1,0,0)),e=x(e,d.set(0,1,0)),e=x(e,d.set(0,-1,0)),e=x(e,d.set(0,0,1)),e=x(e,d.set(0,0,-1)),t=0;t<e.length;t++){const f=e[t];M.push(.5+f.position.x/T.x,.5+f.position.y/T.y),f.position.applyMatrix4(y),l.push(f.position.x,f.position.y,f.position.z),w.push(f.normal.x,f.normal.y,f.normal.z)}}function A(t,e,o){e.applyMatrix4(p.matrixWorld),e.applyMatrix4(j),o.transformDirection(p.matrixWorld),t.push(new U(e.clone(),o.clone()))}function x(t,e){const o=[],s=.5*Math.abs(T.dot(e));for(let n=0;n<t.length;n+=3){let E,b,f,C=0,u,m,g,D;const X=t[n+0].position.dot(e)-s,Z=t[n+1].position.dot(e)-s,$=t[n+2].position.dot(e)-s;switch(E=X>0,b=Z>0,f=$>0,C=(E?1:0)+(b?1:0)+(f?1:0),C){case 0:{o.push(t[n]),o.push(t[n+1]),o.push(t[n+2]);break}case 1:{if(E&&(u=t[n+1],m=t[n+2],g=a(t[n],u,e,s),D=a(t[n],m,e,s)),b){u=t[n],m=t[n+2],g=a(t[n+1],u,e,s),D=a(t[n+1],m,e,s),o.push(g),o.push(m.clone()),o.push(u.clone()),o.push(m.clone()),o.push(g.clone()),o.push(D);break}f&&(u=t[n],m=t[n+1],g=a(t[n+2],u,e,s),D=a(t[n+2],m,e,s)),o.push(u.clone()),o.push(m.clone()),o.push(g),o.push(D),o.push(g.clone()),o.push(m.clone());break}case 2:{E||(u=t[n].clone(),m=a(u,t[n+1],e,s),g=a(u,t[n+2],e,s),o.push(u),o.push(m),o.push(g)),b||(u=t[n+1].clone(),m=a(u,t[n+2],e,s),g=a(u,t[n],e,s),o.push(u),o.push(m),o.push(g)),f||(u=t[n+2].clone(),m=a(u,t[n],e,s),g=a(u,t[n+1],e,s),o.push(u),o.push(m),o.push(g));break}}}return o}function a(t,e,o,s){const n=t.position.dot(o)-s,E=e.position.dot(o)-s,b=n/(n-E);return new U(new B(t.position.x+b*(e.position.x-t.position.x),t.position.y+b*(e.position.y-t.position.y),t.position.z+b*(e.position.z-t.position.z)),new B(t.normal.x+b*(e.normal.x-t.normal.x),t.normal.y+b*(e.normal.y-t.normal.y),t.normal.z+b*(e.normal.z-t.normal.z)))}}}class U{constructor(p,h){this.position=p,this.normal=h}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}const F=r=>r===Object(r)&&!Array.isArray(r)&&typeof r!="function";function W(r,p){const h=N(l=>l.gl),c=P(S,F(r)?Object.values(r):r);return i.useLayoutEffect(()=>{p==null||p(c)},[p]),i.useEffect(()=>{if("initTexture"in h){let l=[];Array.isArray(c)?l=c:c instanceof I?l=[c]:F(c)&&(l=Object.values(c)),l.forEach(w=>{w instanceof I&&h.initTexture(w)})}},[h,c]),i.useMemo(()=>{if(F(r)){const l={};let w=0;for(const M in r)l[M]=c[w++];return l}else return c},[r,c])}W.preload=r=>P.preload(S,r);W.clear=r=>P.clear(S,r);function nt(r){return Array.isArray(r)}function L(r=[0,0,0]){return nt(r)?r:r instanceof B||r instanceof _?[r.x,r.y,r.z]:[r,r,r]}const st=i.forwardRef(function({debug:p,depthTest:h=!1,polygonOffsetFactor:c=-10,map:T,mesh:l,children:w,position:M,rotation:d,scale:y,...j},k){const A=i.useRef(null);i.useImperativeHandle(k,()=>A.current);const x=i.useRef(null);return i.useLayoutEffect(()=>{const a=(l==null?void 0:l.current)||A.current.parent,t=A.current;if(!(a instanceof q))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const e={position:new B,rotation:new _,scale:new B(1,1,1)};if(a){G(e,{position:M,scale:y});const o=a.matrixWorld.clone();if(a.matrixWorld.identity(),!d||typeof d=="number"){const s=new J;s.position.copy(e.position),s.lookAt(a.position),typeof d=="number"&&s.rotateZ(d),G(e,{rotation:s.rotation})}else G(e,{rotation:d});return t.geometry=new rt(a,e.position,e.rotation,e.scale),x.current&&(G(x.current,e),x.current.traverse(s=>s.raycast=()=>null)),a.matrixWorld=o,()=>{t.geometry.dispose()}}},[l,...L(M),...L(y),...L(d)]),i.createElement("mesh",K({ref:A,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":c,"material-depthTest":h,"material-map":T},j),w,p&&i.createElement("mesh",{ref:x},i.createElement("boxGeometry",null),i.createElement("meshNormalMaterial",{wireframe:!0}),i.createElement("axesHelper",null)))}),at=i.forwardRef(({children:r,enabled:p=!0,speed:h=1,rotationIntensity:c=1,floatIntensity:T=1,floatingRange:l=[-.1,.1],autoInvalidate:w=!1,...M},d)=>{const y=i.useRef(null);i.useImperativeHandle(d,()=>y.current,[]);const j=i.useRef(Math.random()*1e4);return Q(k=>{var A,x;if(!p||h===0)return;w&&k.invalidate();const a=j.current+k.clock.getElapsedTime();y.current.rotation.x=Math.cos(a/4*h)/8*c,y.current.rotation.y=Math.sin(a/4*h)/8*c,y.current.rotation.z=Math.sin(a/4*h)/20*c;let t=Math.sin(a/4*h)/10;t=Y.mapLinear(t,-.1,.1,(A=l==null?void 0:l[0])!==null&&A!==void 0?A:-.1,(x=l==null?void 0:l[1])!==null&&x!==void 0?x:.1),y.current.position.y=t*T,y.current.updateMatrix()}),i.createElement("group",M,i.createElement("group",{ref:y,matrixAutoUpdate:!1},r))}),lt=r=>{const[p]=W([r.imgUrl]);return z(at,{speed:1.75,rotationIntensity:1,floatIntensity:2,children:[O("ambientLight",{intensity:.25}),O("directionalLight",{position:[0,0,.05]}),z("mesh",{castShadow:!0,receiveShadow:!0,scale:2.75,children:[O("icosahedronGeometry",{args:[1,1]}),O("meshStandardMaterial",{color:"#fff8eb",polygonOffset:!0,polygonOffsetFactor:-5,flatShading:!0}),O(st,{position:[0,0,1],rotation:[2*Math.PI,0,6.25],scale:1,map:p,flatShading:!0})]})]})},it=({icon:r})=>z(V,{frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},children:[z(i.Suspense,{fallback:O(tt,{}),children:[O(et,{enableZoom:!1}),O(lt,{imgUrl:r})]}),O(ot,{all:!0})]});export{it as default};
